#Requires AutoHotkey v2.0
#SingleInstance Force
SetWorkingDir A_ScriptDir
CoordMode "Mouse", "Screen"

macroRunning := false
chosenSide := ""

; Default coordinates (2560x1440)
farmBtn     := [1472, 83]
eggsBtn     := [986, 83]
sellBtn     := [0, 0] ; HUSK
btn1        := [850, 571]
btn2        := [1520, 564]
btn3        := [848, 936]
claimBtn    := [1281, 969]
sellpetsBtn := [0, 0] ; HUSK
middleshopGUI := [1281, 671]
plantBtn    := [0, 0] ; HUSK

; Hotkeys
Hotkey "F3", StartMacro
Hotkey "F4", (*) => ExitApp()

StartMacro(*) {
    global macroRunning, chosenSide
    if macroRunning
        return

    ; Depends what side you're on
    answer := MsgBox("Choose your side:`nYes = Right (Presses D)`nNo = Left (Presses A)", "Side Selection", 0x33)
    if answer = "Yes"
        chosenSide := "right"
    else if answer = "No"
        chosenSide := "left"
    else
        return

    macroRunning := true
    SetTimer DoTasks, 360000
    DoTasks()
}

; Reliable clicking method
ReliableClick(x, y) {
    randX := x + Random(-5, 5)
    randY := y + Random(-5, 5)
    Click randX, randY
}

DoTasks() {
    global chosenSide, farmBtn, eggsBtn, sellBtn, btn1, btn2, btn3, claimBtn, sellpetsBtn, middleshopGUI
    
    Loop 120 { ; Sets the camera straight
    ;Loop 2 {  ; For debuggning
        ReliableClick(farmBtn*)
        Sleep 90
    }

    Sleep 5000

;;;; Sell Function
    Loop 5 { ; Teleports to sgop
        ReliableClick(sellBtn*)
        Sleep 90
    }
    
    Sleep 1000

    if chosenSide = "right" { ; Side chosen
        Send "{d down}"
        Sleep 400
        Send "{d up}"
    } else {
        Send "{a down}"
        Sleep 400
        Send "{a up}"
    }

    Sleep 1000

    ReliableClick(sellpetsBtn*) ; Sells pets

    Sleep 5000


;;;; Egg Buy
    Loop 5 { ; Goes to egg shop
        ReliableClick(eggsBtn*)
        Sleep 90
    }
    
    Sleep 1000

    if chosenSide = "right" { ; Depends if your on what side
        Send "{d down}"
        Sleep 400
        Send "{d up}"
    } else {
        Send "{a down}"
        Sleep 400
        Send "{a up}"
    }

    Sleep 1000

    ;ReliableClick(middleshop*)
    MouseMove(middleshopGUI*) ; Moves mouse to GUI center
    ReliableClick(middleshopGUI*)
    
    Loop 15 {
        Sleep 250
        Send "{WheelDown}" ; Scrolls down
        Sleep 250
    }

    Sleep 1000

    Loop 10 { ; buys three bottom pets
        ReliableClick(btn1*)
        Sleep 250
        ReliableClick(btn2*)
        Sleep 250
        ReliableClick(btn3*)
        Sleep 250
    }

    Sleep 5000

;;;; Claim Function
    Loop 30 { ; Goes to farm, makes sure the cam is right pos
        ReliableClick(farmBtn*)
        Sleep 90
    }
    Sleep 5000
    MouseMove(claimBtn*) ; Moves to claiming button
    Send "{s down}"
    Sleep 3000
    Send "{s up}"
    Sleep 1000
    ReliableClick(claimBtn*)
    Sleep 5000

;;;; Plants eggs in hotbar
    Loop 5 { ; Goes to farm, makes sure the cam is right pos
        ReliableClick(farmBtn*)
        Sleep 90
    }

    Send "{s down}"
    Sleep 100
    Send "{s up}"
    
    Send "{1 down}"
    Sleep 50
    Send "{1 up}"
    Loop 20 { 
        ReliableClick(plantBtn*)
        Sleep 90
    }

    Send "{2 down}"
    Sleep 50
    Send "{2 up}"
    Loop 20 { 
        ReliableClick(plantBtn*)
        Sleep 90
    }



    










    

}
